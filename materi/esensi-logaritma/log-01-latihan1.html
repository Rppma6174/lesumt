<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latihan Soal 1: Esensi Logaritma - UMT Learning</title>
    <link rel="icon" type="image/png" href="../UMT-Logo - Copy.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
      MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary-purple: #8A2BE2;
            --dark-bg: #141414;
            --card-bg: #1c1c1c;
            --border-color: #333;
            --text-primary: #ffffff;
            --text-secondary: #ccc;
            --text-muted: #888;
            --success-color: #28a745;
            --error-color: #dc3545;
            --warning-color: #ffc107;
        }
        body {
            background-color: var(--dark-bg);
            color: var(--text-primary);
            font-family: 'Poppins', sans-serif;
            line-height: 1.7;
        }
        .container { 
            max-width: 800px; 
            margin: 2rem auto; 
            padding: 1.5rem 2rem; 
            background-color: var(--card-bg); 
            border: 1px solid var(--border-color); 
            border-radius: 12px; 
        }
        .back-link {
            position: fixed; bottom: 2rem; right: 2rem; z-index: 1000;
            background-color: var(--primary-purple); color: white; width: 50px; height: 50px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; text-decoration: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.2s ease; cursor: pointer;
        }
        .back-link:hover { transform: scale(1.1); }
        h1, h2 { color: var(--primary-purple); }
        h1 { font-size: 2.2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-bottom: 1.5rem; font-weight: 700; }
        h2 { font-size: 1.6rem; margin-top: 2.5rem; margin-bottom: 1.5rem; border-left: 4px solid var(--primary-purple); padding-left: 1rem; font-weight: 600; }
        
        .question-block {
            border-top: 1px solid var(--border-color);
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }
        .question-text {
            font-size: 1.1em;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }
        .question-text strong {
            color: var(--primary-purple);
            font-size: 1.2em;
            margin-right: 0.5rem;
        }

        .upload-section {
            background-color: var(--dark-bg);
            padding: 2rem;
            border: 1px dashed var(--border-color);
            border-radius: 10px;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        
        .upload-section h3 {
            color: var(--primary-purple);
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .upload-section p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .file-upload-input { display: none; }
        .upload-label {
            display: inline-block; padding: 12px 24px;
            background-color: var(--primary-purple); color: var(--text-primary);
            border-radius: 8px; cursor: pointer; transition: background-color 0.2s; font-weight: 500;
        }
        .upload-label:hover { background-color: #7D2ED1; }
        .file-name-display {
            display: inline-block; margin-left: 15px; font-size: 0.9em;
            color: var(--text-muted); font-style: italic;
        }
        
        .submit-button {
            display: block; width: 100%; padding: 15px; background-color: var(--success-color);
            color: var(--text-primary); border: none; border-radius: 8px; font-size: 18px;
            font-weight: 600; text-align: center; cursor: pointer; margin-top: 3rem;
            transition: all 0.3s ease;
        }
        .submit-button:hover { background-color: #218838; transform: translateY(-2px); }
        .submit-button:disabled { background-color: var(--text-muted); cursor: not-allowed; transform: none; }
        
        /* --- MODAL STYLES --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; z-index: 2000;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            background-color: var(--card-bg); padding: 30px; border-radius: 15px;
            border: 1px solid var(--border-color); box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            width: 90%; max-width: 500px; text-align: center;
            transform: scale(0.9); transition: transform 0.3s;
        }
        .modal-overlay.active .modal-content { transform: scale(1); }
        .modal-content h3 { margin-top: 0; color: var(--primary-purple); font-weight: 600; font-size: 1.5rem; }
        .modal-content p { color: var(--text-secondary); margin-bottom: 25px; line-height: 1.6; }
        .modal-content ul { text-align: left; color: var(--text-secondary); margin: 20px 0; }
        .modal-content ul li { margin-bottom: 10px; }
        .modal-footer { display: flex; gap: 10px; }
        .modal-footer button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .modal-footer .confirm-btn { background-color: var(--success-color); color: white; }
        .modal-footer .confirm-btn:hover { background-color: #218838; }
        .modal-footer .cancel-btn { background-color: var(--text-muted); color: white; }
        .modal-footer .cancel-btn:hover { background-color: #5a5a5a; }
        .modal-footer .close-btn { background-color: var(--primary-purple); color: white; width: 100%; }
        .modal-footer .close-btn:hover { background-color: #7D2ED1; }

        .warning-icon {
            font-size: 4rem;
            color: var(--warning-color);
            margin-bottom: 1rem;
        }

        .success-icon {
            font-size: 4rem;
            color: var(--success-color);
            margin-bottom: 1rem;
        }

        /* --- NOTIFICATION TOAST --- */
        .toast-notification {
            position: fixed; top: -100px; left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px; border-radius: 8px;
            color: white; font-weight: 500;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            transition: top 0.5s ease-in-out; z-index: 3000;
        }
        .toast-notification.show { top: 20px; }
        .toast-notification.success { background-color: var(--success-color); }
        .toast-notification.error { background-color: var(--error-color); }
        .toast-notification.warning { background-color: var(--warning-color); color: #000; }

        p, li { color: var(--text-secondary); }
    </style>
</head>
<body>
    <div id="toast" class="toast-notification">Pesan Notifikasi</div>

    <div id="warning-modal" class="modal-overlay active">
        <div class="modal-content">
            <div class="warning-icon">‚ö†Ô∏è</div>
            <h3>PERHATIAN PENTING!</h3>
            <p style="font-size: 1.05rem; font-weight: 500;">Untuk memaksimalkan pembelajaran Anda:</p>
            <ul>
                <li>üö´ <strong>DILARANG KERAS</strong> menggunakan AI (ChatGPT, dll) atau Google untuk mencari jawaban</li>
                <li>üìö Jawablah berdasarkan <strong>pemahaman Anda sendiri</strong> dari materi yang telah dipelajari</li>
                <li>üí° Ini adalah <strong>latihan</strong> - kesalahan adalah bagian dari proses belajar</li>
                <li>üéØ Paksa diri Anda untuk berpikir dan mengingat materi</li>
            </ul>
            <p style="color: var(--warning-color); font-weight: 600; margin-top: 20px;">Hasil terbaik datang dari usaha Anda sendiri!</p>
            <div class="modal-footer">
                <button id="close-warning-btn" class="close-btn">Saya Mengerti, Mulai Latihan</button>
            </div>
        </div>
    </div>

    <div id="confirmation-modal" class="modal-overlay">
        <div class="modal-content">
            <h3>Konfirmasi Pengiriman</h3>
            <p>Pastikan setiap jawaban dan pembahasan cara yang Anda kirimkan tulisannya sudah jelas dan rapi agar dapat mempermudah bagi mentor untuk menilainya.</p>
            <div class="modal-footer">
                <button id="cancel-submit-btn" class="cancel-btn">Batal</button>
                <button id="confirm-submit-btn" class="confirm-btn">Ya, Kirim Sekarang</button>
            </div>
        </div>
    </div>

    <div id="back-warning-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="warning-icon">üö´</div>
            <h3>Tidak Bisa Kembali!</h3>
            <p>Anda belum mengirimkan semua jawaban. Silakan selesaikan dan kirim semua jawaban terlebih dahulu sebelum keluar dari halaman ini.</p>
            <div class="modal-footer">
                <button id="close-back-warning-btn" class="close-btn">Mengerti</button>
            </div>
        </div>
    </div>

    <div id="success-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="success-icon">üéâ</div>
            <h3>Selamat! Latihan Selesai</h3>
            <p>Jawaban Anda telah berhasil dikirim. Progress Anda telah disimpan dan tahapan berikutnya sudah terbuka.</p>
            <p style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 20px;">Unduh soal dalam bentuk PDF untuk referensi belajar Anda.</p>
            <div class="modal-footer" style="flex-direction: column;">
                
                <a 
                  href="https://drive.google.com/uc?id=151VUa6WEJCLvBmG4DHg6fuRBzugC8PXt&export=download" 
                  download="Latihan-Soal-1-Esensi-Logaritma.pdf" 
                  id="download-pdf-modal-btn" 
                  style="display: block; text-decoration: none; background-color: var(--primary-purple); color: white; width: 100%; margin-bottom: 10px; padding: 14px; border-radius: 8px; font-size: 16px; font-weight: 600; text-align: center; box-sizing: border-box; transition: background-color 0.2s;"
                  onmouseover="this.style.backgroundColor='#7D2ED1'" 
                  onmouseout="this.style.backgroundColor='var(--primary-purple)'">
                    <i class="fas fa-download"></i> Unduh Soal (PDF)
                </a>

                <button id="skip-to-roadmap-btn" style="background-color: var(--success-color); color: white; width: 100%; padding: 14px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">
                    Lanjut ke Roadmap
                </button>
            </div>
            <p id="countdown-text" style="font-size: 0.85rem; color: var(--text-muted); margin-top: 15px;">Atau tunggu <span id="countdown">10</span> detik...</p>
        </div>
    </div>

    <div class="container">
        <a id="back-link" class="back-link" title="Kembali ke Daftar Materi">
            <i class="fas fa-arrow-left"></i>
        </a>
        
        <h1>Latihan Soal 1: Esensi Logaritma</h1>
        <p>
            Kerjakan soal-soal di bawah ini dengan menuliskan cara kerja dan penjelasan Anda. Setelah menyelesaikan semua soal, foto atau scan jawaban Anda untuk semua soal, lalu upload file tersebut dalam satu bagian yang disediakan di bawah.
        </p>

        <h2>Soal Level LOTS</h2>
        <div class="question-block">
            <p class="question-text"><strong>1.</strong> Nyatakan bentuk eksponen $5^3 = 125$ ke dalam bentuk logaritma yang ekuivalen.</p>
        </div>
        <div class="question-block">
            <p class="question-text"><strong>2.</strong> Tentukan nilai pasti dari $^4\log 64$.</p>
        </div>

        <h2>Soal Level MOTS</h2>
        <div class="question-block">
            <p class="question-text"><strong>3.</strong> Jika diketahui $^x\log 81 = 4$, tentukan nilai $x$. Jelaskan langkah-langkahmu menggunakan definisi dasar logaritma.</p>
        </div>
        <div class="question-block">
            <p class="question-text"><strong>4.</strong> Tentukan semua nilai $x$ yang mungkin agar fungsi $f(x) = \log(3x - 12)$ terdefinisi. Jelaskan alasanmu berdasarkan syarat numerus.</p>
        </div>

        <h2>Soal Level HOTS</h2>
        <div class="question-block">
            <p class="question-text"><strong>5.</strong> Tanpa kalkulator, bandingkan $A = {^2\log 30}$ dan $B = 5$. Manakah yang lebih besar? Berikan penjelasan logis.</p>
        </div>
        <div class="question-block">
            <p class="question-text"><strong>6.</strong> Jelaskan mengapa nilai dari $^a\log 1$ selalu sama dengan 0, untuk basis $a$ manapun yang valid. Kaitkan penjelasanmu dengan definisi eksponen.</p>
        </div>

        <div class="upload-section">
            <h3>üì§ Upload Jawaban Anda</h3>
            <p>Foto atau scan <strong>semua jawaban Anda</strong> untuk soal 1-6 dalam <strong>satu file</strong> (PDF, gambar, atau dokumen lain), lalu upload di sini. Pastikan tulisan Anda jelas dan rapi agar mudah dinilai oleh mentor.</p>
            <label for="combined_upload" class="upload-label">
                <i class="fas fa-cloud-upload-alt"></i> Pilih File Jawaban
            </label>
            <input type="file" id="combined_upload" class="file-upload-input" accept="image/*,.pdf,.doc,.docx">
            <span class="file-name-display">Belum ada file dipilih</span>
        </div>

        <button id="submit-button" class="submit-button">Kirim Jawaban</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ============ KONFIGURASI PROGRESS ============
            const SUB_MATERI_ID = "log_1";
            const CURRENT_STAGE_ID = "latihan1";
            const ROADMAP_PATH = "../esensi-logaritma/";
            // ==============================================

            const fileInput = document.getElementById('combined_upload');
            const submitButton = document.getElementById('submit-button');
            const confirmationModal = document.getElementById('confirmation-modal');
            const confirmSubmitBtn = document.getElementById('confirm-submit-btn');
            const cancelSubmitBtn = document.getElementById('cancel-submit-btn');
            const warningModal = document.getElementById('warning-modal');
            const closeWarningBtn = document.getElementById('close-warning-btn');
            const backWarningModal = document.getElementById('back-warning-modal');
            const closeBackWarningBtn = document.getElementById('close-back-warning-btn');
            const successModal = document.getElementById('success-modal');
            // Tombol unduh tidak perlu di-handle JavaScript lagi
            // const downloadPdfModalBtn = document.getElementById('download-pdf-modal-btn'); 
            const skipToRoadmapBtn = document.getElementById('skip-to-roadmap-btn');
            const countdownElement = document.getElementById('countdown');
            const backLink = document.getElementById('back-link');
            const toast = document.getElementById('toast');
            
            let isSubmitted = false;
            let countdownInterval = null;

            // Tutup modal peringatan awal
            closeWarningBtn.addEventListener('click', () => {
                warningModal.classList.remove('active');
            });

            // Fungsi untuk menampilkan notifikasi toast
            function showNotification(message, type) {
                toast.textContent = message;
                toast.className = 'toast-notification';
                toast.classList.add(type);
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }

            // Menangani tampilan nama file setelah diupload
            fileInput.addEventListener('change', (event) => {
                const fileNameDisplay = event.target.nextElementSibling;
                if (event.target.files.length > 0) {
                    fileNameDisplay.textContent = event.target.files[0].name;
                } else {
                    fileNameDisplay.textContent = 'Belum ada file dipilih';
                }
            });

            // Cegah kembali jika belum submit
            backLink.addEventListener('click', (e) => {
                e.preventDefault();
                if (!isSubmitted) {
                    backWarningModal.classList.add('active');
                } else {
                    window.location.href = ROADMAP_PATH;
                }
            });

            closeBackWarningBtn.addEventListener('click', () => {
                backWarningModal.classList.remove('active');
            });

            // Tampilkan modal konfirmasi saat tombol kirim diklik
            submitButton.addEventListener('click', () => {
                if (fileInput.files.length === 0) {
                    showNotification('Harap upload file jawaban Anda.', 'error');
                    return;
                }
                confirmationModal.classList.add('active');
            });

            // Sembunyikan modal saat tombol 'Batal' atau area luar diklik
            cancelSubmitBtn.addEventListener('click', () => confirmationModal.classList.remove('active'));
            confirmationModal.addEventListener('click', (e) => {
                if (e.target === confirmationModal) {
                    confirmationModal.classList.remove('active');
                }
            });

            // Logika pengiriman setelah konfirmasi
            confirmSubmitBtn.addEventListener('click', () => {
                confirmationModal.classList.remove('active');
                submitButton.disabled = true;
                submitButton.textContent = 'Mengirim...';
                const formData = new FormData();
                formData.append('jawaban_soal', fileInput.files[0]);
                kirimKeTelegram(formData);
            });

            // Fungsi untuk menyimpan progress ke localStorage
            function markStageCompleted() {
                const storageKey = `progress_${SUB_MATERI_ID}_${CURRENT_STAGE_ID}`;
                localStorage.setItem(storageKey, 'completed');
                console.log(`Progress saved: ${storageKey} = completed`);
            }

            // Fungsi kirim ke Telegram
            async function kirimKeTelegram(formData) {
                // ============ KONFIGURASI BOT TELEGRAM ============
                const BOT_TOKEN = '8386335553:AAGDw3mqCWGgZCUL4kUZ198nIb00Jv3tQoQ';
                const CHAT_ID = '6919363709';
                // ==================================================

                try {
                    const namaUser = prompt("Masukkan nama Anda (untuk identifikasi):") || "Anonim";
                    const timestamp = new Date().toLocaleString('id-ID', { 
                        dateStyle: 'full', 
                        timeStyle: 'short' 
                    });

                    const pesanPembuka = `üìù *LATIHAN SOAL 1: ESENSI LOGARITMA*\n\n` +
                                         `üë§ Nama: ${namaUser}\n` +
                                         `üïê Waktu: ${timestamp}\n` +
                                         `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;

                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: CHAT_ID, text: pesanPembuka, parse_mode: 'Markdown' })
                    });

                    const file = formData.get('jawaban_soal');
                    if (file) {
                        const fileFormData = new FormData();
                        fileFormData.append('chat_id', CHAT_ID);
                        fileFormData.append('document', file);
                        fileFormData.append('caption', `üìÑ Jawaban Lengkap Soal 1-6 - ${namaUser}`);

                        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`, {
                            method: 'POST',
                            body: fileFormData
                        });
                        if (!response.ok) throw new Error('Gagal mengirim file');
                    }

                    const pesanPenutup = `‚úÖ *Pengiriman Selesai*\n\n` + `Jawaban telah diterima dan akan dinilai oleh mentor.\n` + `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: CHAT_ID, text: pesanPenutup, parse_mode: 'Markdown' })
                    });

                    markStageCompleted();
                    submitButton.disabled = false;
                    submitButton.textContent = 'Kirim Jawaban';
                    isSubmitted = true;
                    fileInput.value = '';
                    fileInput.nextElementSibling.textContent = 'Belum ada file dipilih';
                    successModal.classList.add('active');
                    
                    let countdown = 10;
                    countdownElement.textContent = countdown;
                    countdownInterval = setInterval(() => {
                        countdown--;
                        countdownElement.textContent = countdown;
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            window.location.href = ROADMAP_PATH;
                        }
                    }, 1000);

                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Gagal mengirim jawaban. Periksa koneksi atau BOT TOKEN.', 'error');
                    submitButton.disabled = false;
                    submitButton.textContent = 'Kirim Jawaban';
                }
            }

            // Fungsi generatePDF sudah dihapus karena tidak diperlukan lagi

            // Tombol skip langsung ke roadmap
            skipToRoadmapBtn.addEventListener('click', () => {
                clearInterval(countdownInterval);
                window.location.href = ROADMAP_PATH;
            });
        });
    </script>
</body>
</html>
